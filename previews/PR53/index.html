<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · TimeseriesSurrogates.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">TimeseriesSurrogates.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#TODO:-add-example-figure-here.-1"><span>TODO: add example figure here.</span></a></li><li><a class="tocitem" href="#API-1"><span>API</span></a></li><li><a class="tocitem" href="#Surrogate-methods-1"><span>Surrogate methods</span></a></li><li><a class="tocitem" href="#Visualization-1"><span>Visualization</span></a></li></ul></li><li><a class="tocitem" href="man/whatisasurrogate/">What is a surrogate?</a></li><li><span class="tocitem">Example applications</span><ul><li><a class="tocitem" href="constrained/randomshuffle/">Shuffle-based</a></li><li><a class="tocitem" href="constrained/fourier_surrogates/">Fourier-based</a></li><li><a class="tocitem" href="constrained/amplitude_adjusted/">Amplitude-adjusted FT</a></li><li><a class="tocitem" href="constrained/pps/">Pseudo-periodic</a></li></ul></li><li><a class="tocitem" href="man/exampleprocesses/">Utility systems</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Overview-1"><a class="docs-heading-anchor" href="#Overview-1">Overview</a><a class="docs-heading-anchor-permalink" href="#Overview-1" title="Permalink"></a></h1><h1 id="TODO:-add-example-figure-here.-1"><a class="docs-heading-anchor" href="#TODO:-add-example-figure-here.-1">TODO: add example figure here.</a><a class="docs-heading-anchor-permalink" href="#TODO:-add-example-figure-here.-1" title="Permalink"></a></h1><p>If you are new to this method of <a href="https://en.wikipedia.org/wiki/Surrogate_data_testing">surrogate time series</a>, feel free to read any of the following:</p><ol><li><a href="man/whatisasurrogate/#The-method-of-surrogate-testing-1">The method of surrogate testing</a></li><li><a href="man/whatisasurrogate/#What-is-a-surrogate-time-series?-1">What is a surrogate time series?</a></li><li><a href="man/whatisasurrogate/#Types-of-surrogate-realizations-1">Types of surrogate realizations</a></li></ol><h2 id="API-1"><a class="docs-heading-anchor" href="#API-1">API</a><a class="docs-heading-anchor-permalink" href="#API-1" title="Permalink"></a></h2><p>TimeseriesSurrogates.jl exports two main functions. Both of them dispatch on the chosen method, a subtype of <code>Surrogate</code>.</p><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.surrogate" href="#TimeseriesSurrogates.surrogate"><code>TimeseriesSurrogates.surrogate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">surrogate(x, method::Surrogate) → s</code></pre><p>Create a single surrogate timeseries <code>s</code> from <code>x</code> based on the given <code>method</code>. If you want to generate more than one surrogates from <code>x</code>, you should use <a href="#TimeseriesSurrogates.surrogenerator"><code>surrogenerator</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/api.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.surrogenerator" href="#TimeseriesSurrogates.surrogenerator"><code>TimeseriesSurrogates.surrogenerator</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">surrogenerator(x, method::Surrogate) → sg::SurrogateGenerator</code></pre><p>Initialize a generator that creates surrogates of <code>x</code> on demand, based on given <code>method</code>. This is efficient, because for most methods some things can be initialized and reused for every surrogate.</p><p>To generate a surrogate, call <code>sg</code> as a function with no arguments, e.g.:</p><pre><code class="language-julia">sg = surrogenerator(x, method)
for i in 1:1000
    s = sg()
    # do stuff with s and or x
    result[i] = stuff
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/api.jl#L12-L27">source</a></section></article><h2 id="Surrogate-methods-1"><a class="docs-heading-anchor" href="#Surrogate-methods-1">Surrogate methods</a><a class="docs-heading-anchor-permalink" href="#Surrogate-methods-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.RandomShuffle" href="#TimeseriesSurrogates.RandomShuffle"><code>TimeseriesSurrogates.RandomShuffle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RandomShuffle() &lt;: Surrogate</code></pre><p>A random constrained surrogate, generated by shifting values around.</p><p>This method destroys any linear correlation in the signal, but preserves its amplitude distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/randomshuffle.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.BlockShuffle" href="#TimeseriesSurrogates.BlockShuffle"><code>TimeseriesSurrogates.BlockShuffle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">BlockShuffle(n::Int) &lt;: Surrogate</code></pre><p>A block shuffle surrogate constructed by dividing the time series into <code>n</code> blocks of roughly equal width at random indices (end blocks are wrapped around to the start of the time series).</p><p>These surrogates preserve short-term correlations in the time series, but break any long-term dynamical information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/blockshuffle.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.RandomFourier" href="#TimeseriesSurrogates.RandomFourier"><code>TimeseriesSurrogates.RandomFourier</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RandomFourier(phases = true) &lt;: Surrogate</code></pre><p>A surrogate<sup class="footnote-reference"><a id="citeref-Theiler1992" href="#footnote-Theiler1992">[Theiler1992]</a></sup> that randomizes the Fourier components of the signal in some manner. If <code>phases==true</code>, the phases are randomized, otherwise the amplitudes are randomized.</p><p>If <code>phases==true</code>, then the resulting signal has same linear correlation, or periodogram, as the original data.</p><p>#TODO: Okay, what happens if <code>phases!=true</code> ?</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/randomfourier.jl#L2-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.AAFT" href="#TimeseriesSurrogates.AAFT"><code>TimeseriesSurrogates.AAFT</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AAFT()</code></pre><p>An amplitude-adjusted-fourier-transform surrogate<sup class="footnote-reference"><a id="citeref-Theiler1992" href="#footnote-Theiler1992">[Theiler1992]</a></sup>.</p><p>AAFT have the same linear correlation, or periodogram, and also preserves the amplitude distribution of the original data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/aaft.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.IAAFT" href="#TimeseriesSurrogates.IAAFT"><code>TimeseriesSurrogates.IAAFT</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">IAAFT(M = 100, tol = 1e-6, W = 75)</code></pre><p>An iteratively adjusted amplitude-adjusted-fourier-transform surrogate<sup class="footnote-reference"><a id="citeref-SchreiberSchmitz1996" href="#footnote-SchreiberSchmitz1996">[SchreiberSchmitz1996]</a></sup>.</p><p>IAAFT surrogate have the same linear correlation, or periodogram, and also preserves the amplitude distribution of the original data, but are improved relative to AAFT through iterative adjustment (which runs for a maximum of <code>M</code> steps). During the iterative adjustment, the periodograms of the original signal and the surrogate are coarse-grained and the powers are averaged over <code>W</code> equal-width frequency bins. The iteration procedure ends when the relative deviation between the periodograms is less than <code>tol</code> (or when <code>M</code> is reached).</p><p><strong>References</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/iaaft.jl#L2-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.PseudoPeriodic" href="#TimeseriesSurrogates.PseudoPeriodic"><code>TimeseriesSurrogates.PseudoPeriodic</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">PseudoPeriodic(d, τ, ρ, shift=true) &lt;: Surrogate</code></pre><p>Create surrogates suitable for pseudo-periodic signals. They retain the periodic structure of the signal, while inter-cycle dynamics that are either deterministic or correlated noise are destroyed (for appropriate <code>ρ</code> choice). Therefore these surrogates are suitable to test the null hypothesis that the signal is periodic with uncorrelated noise<sup class="footnote-reference"><a id="citeref-Small2001" href="#footnote-Small2001">[Small2001]</a></sup>.</p><p>Arguments <code>d, τ, ρ</code> are as in the paper, the embedding dimension, delay time and noise radius. The method works by performing a delay coordinates ambedding via the library <a href="https://juliadynamics.github.io/DynamicalSystems.jl/dev/embedding/reconstruction/">DynamicalSystems.jl</a>. See its documentation for choosing appropriate values for <code>d, τ</code>. For <code>ρ</code>, we have implemented the method proposed in the paper in the function <a href="#TimeseriesSurrogates.noiseradius"><code>noiseradius</code></a>.</p><p>The argument <code>shift</code> is not discussed in the paper, but it is possible to adjust the algorithm so that there is no phase shift between the periodic component of the original and surrogate data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/pseudoperiodic.jl#L3-L23">source</a></section></article><h3 id="Utils-1"><a class="docs-heading-anchor" href="#Utils-1">Utils</a><a class="docs-heading-anchor-permalink" href="#Utils-1" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="TimeseriesSurrogates.noiseradius" href="#TimeseriesSurrogates.noiseradius"><code>TimeseriesSurrogates.noiseradius</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">noiseradius(x::AbstractVector, d::Int, τ, ρs, n = 1) → ρ</code></pre><p>Use the proposed* algorithm of<sup class="footnote-reference"><a id="citeref-Small2001" href="#footnote-Small2001">[Small2001]</a></sup> to estimate optimal <code>ρ</code> value for <a href="#TimeseriesSurrogates.PseudoPeriodic"><code>PseudoPeriodic</code></a> surrogates, where <code>ρs</code> is a vector of possible <code>ρ</code> values.</p><p>*The paper is ambiguous about exactly what to calculate. Here we count how many times we have pairs of length-2 that are identical in <code>x</code> and its surrogate, but <strong>are not</strong> also part of pairs of length-3.</p><p>This function directly returns the arg-maximum of the evaluated distribution of these counts versus <code>ρ</code>, use <code>TimeseriesSurrogates._noiseradius</code> with same arguments to get the actual distribution. <code>n</code> means to repeat τhe evaluation <code>n</code> times, which increases accuracy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/95fb6063f598dbfe366c9701e7defeb4cbd3e6ae/src/methods/pseudoperiodic.jl#L61-L75">source</a></section></article><h2 id="Visualization-1"><a class="docs-heading-anchor" href="#Visualization-1">Visualization</a><a class="docs-heading-anchor-permalink" href="#Visualization-1" title="Permalink"></a></h2><p>TimeseriesSurrogates.jl provides the function <code>surroplot(x, s)</code>, which comes into scope when <code>using Plots</code>. This function is used in the example applications.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Theiler1992"><a class="tag is-link" href="#citeref-Theiler1992">Theiler1992</a>J. Theiler et al., <a href="https://www.sciencedirect.com/science/article/pii/016727899290102S">Physica D <em>58</em> (1992) 77-94 (1992)</a></li><li class="footnote" id="footnote-SchreiberSchmitz1996"><a class="tag is-link" href="#citeref-SchreiberSchmitz1996">SchreiberSchmitz1996</a>T. Schreiber; A. Schmitz (1996). &quot;Improved Surrogate Data for Nonlinearity Tests&quot;. <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.77.635">Phys. Rev. Lett. 77 (4)</a></li><li class="footnote" id="footnote-Small2001"><a class="tag is-link" href="#citeref-Small2001">Small2001</a>Small et al., Surrogate test for pseudoperiodic time series data, <a href="https://doi.org/10.1103/PhysRevLett.87.188101">Physical Review Letters, 87(18)</a></li><li class="footnote" id="footnote-Small2001"><a class="tag is-link" href="#citeref-Small2001">Small2001</a>Small et al., Surrogate test for pseudoperiodic time series data, <a href="https://doi.org/10.1103/PhysRevLett.87.188101">Physical Review Letters, 87(18)</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="man/whatisasurrogate/">What is a surrogate? »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 14 May 2020 22:56">Thursday 14 May 2020</span>. Using Julia version 1.4.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
