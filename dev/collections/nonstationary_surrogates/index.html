<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Surrogates for nonstationary timeseries · TimeseriesSurrogates.jl</title><meta name="title" content="Surrogates for nonstationary timeseries · TimeseriesSurrogates.jl"/><meta property="og:title" content="Surrogates for nonstationary timeseries · TimeseriesSurrogates.jl"/><meta property="twitter:title" content="Surrogates for nonstationary timeseries · TimeseriesSurrogates.jl"/><meta name="description" content="Documentation for TimeseriesSurrogates.jl."/><meta property="og:description" content="Documentation for TimeseriesSurrogates.jl."/><meta property="twitter:description" content="Documentation for TimeseriesSurrogates.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TimeseriesSurrogates.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Documentation</a></li><li><a class="tocitem" href="../../man/whatisasurrogate/">Crash-course in timeseries surrogate testing</a></li><li><span class="tocitem">Example applications</span><ul><li><a class="tocitem" href="../../methods/randomshuffle/">Shuffle-based</a></li><li><a class="tocitem" href="../../methods/fourier_surrogates/">Fourier-based</a></li><li><a class="tocitem" href="../../methods/wls/">Wavelet-based</a></li><li><a class="tocitem" href="../../methods/pps/">Pseudo-periodic</a></li><li><a class="tocitem" href="../../methods/ppts/">Pseudo-periodic twin</a></li><li><a class="tocitem" href="../../methods/multidim/">Multidimensional surrogates</a></li><li><a class="tocitem" href="../irregular_surrogates/">Surrogates for irregular timeseries</a></li><li class="is-active"><a class="tocitem" href>Surrogates for nonstationary timeseries</a><ul class="internal"><li><a class="tocitem" href="#Truncated-Fourier-surrogates"><span>Truncated Fourier surrogates</span></a></li><li><a class="tocitem" href="#Truncated-FT-surrogates-with-trend-removal/addition"><span>Truncated FT surrogates with trend removal/addition</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../man/exampleprocesses/">Utility systems</a></li><li><a class="tocitem" href="../../contributor_guide/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Example applications</a></li><li class="is-active"><a href>Surrogates for nonstationary timeseries</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Surrogates for nonstationary timeseries</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDynamics/TimeseriesSurrogates.jl/blob/main/docs/src/collections/nonstationary_surrogates.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Surrogates-for-nonstationary-time-series"><a class="docs-heading-anchor" href="#Surrogates-for-nonstationary-time-series">Surrogates for nonstationary time series</a><a id="Surrogates-for-nonstationary-time-series-1"></a><a class="docs-heading-anchor-permalink" href="#Surrogates-for-nonstationary-time-series" title="Permalink"></a></h1><p>Several of the methods provided by TimeseriesSurrogates.jl can be used to  construct surrogates for nonstationary time series, which the following examples illustrate.</p><h2 id="Truncated-Fourier-surrogates"><a class="docs-heading-anchor" href="#Truncated-Fourier-surrogates">Truncated Fourier surrogates</a><a id="Truncated-Fourier-surrogates-1"></a><a class="docs-heading-anchor-permalink" href="#Truncated-Fourier-surrogates" title="Permalink"></a></h2><h3 id="[TFTS](@ref)"><a class="docs-heading-anchor" href="#[TFTS](@ref)"><a href="../../#TimeseriesSurrogates.TFTS"><code>TFTS</code></a></a><a id="[TFTS](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TFTS](@ref)" title="Permalink"></a></h3><p>By retaining the lowermost frequencies of the frequency spectrum,  (<a href="../../#TimeseriesSurrogates.TFTS"><code>TFTS</code></a>) surrogates preserve long-term trends in the signals.</p><pre><code class="language-julia hljs">using TimeseriesSurrogates
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

# Preserve 5 % lowermost frequencies.
surroplot(x, surrogate(x, TFTS(0.05)))</code></pre><img src="68b3ca94.png" alt="Example block output"/><h3 id="[TAAFT](@ref)"><a class="docs-heading-anchor" href="#[TAAFT](@ref)"><a href="../../#TimeseriesSurrogates.TAAFT"><code>TAAFT</code></a></a><a id="[TAAFT](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TAAFT](@ref)" title="Permalink"></a></h3><p>Truncated AAFT surrogates (<a href="../../#TimeseriesSurrogates.TAAFT"><code>TAAFT</code></a>) are similar to TFTS surrogates, but also rescales back to the original values of the signal, so that the original signal and the surrogates consists of the same values. This, however, may introduce some bias, as demonstrated below.</p><pre><code class="language-julia hljs">using TimeseriesSurrogates

# Example signal
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

# Preserve 5% of the power spectrum corresponding to the lowest frequencies
s_taaft_lo = surrogate(x, TAAFT(0.05))
surroplot(x, s_taaft_lo)</code></pre><img src="13e9f3e4.png" alt="Example block output"/><pre><code class="language-julia hljs">using TimeseriesSurrogates

# Example signal
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

# Preserve 20% of the power spectrum corresponding to the highest frequencies
s_taaft_hi = surrogate(x, TAAFT(-0.2))
surroplot(x, s_taaft_hi)</code></pre><img src="9e646b9e.png" alt="Example block output"/><h2 id="Truncated-FT-surrogates-with-trend-removal/addition"><a class="docs-heading-anchor" href="#Truncated-FT-surrogates-with-trend-removal/addition">Truncated FT surrogates with trend removal/addition</a><a id="Truncated-FT-surrogates-with-trend-removal/addition-1"></a><a class="docs-heading-anchor-permalink" href="#Truncated-FT-surrogates-with-trend-removal/addition" title="Permalink"></a></h2><p>One solution is to combine truncated Fourier surrogates with detrending/retrending.  For time series with strong trends, Lucio et al. (2012)<sup class="footnote-reference"><a id="citeref-Lucio2012" href="#footnote-Lucio2012">[Lucio2012]</a></sup> proposes variants  of the truncated Fourier-based surrogates wherein the trend is removed prior to surrogate generation, and then added to the surrogate again after it has been generated.  This yields surrogates quite similar to those obtained when using truncated Fourier  surrogates (e.g. <a href="../../#TimeseriesSurrogates.TFTS"><code>TFTS</code></a>), but reducing the effects of endpoint mismatch that  affects regular truncated Fourier transform based surrogates.</p><p>In principle, any trend could be removed/added to the signal. For now, the only  option is to remove a best-fit linear trend obtained by ordinary least squares  regression.</p><h3 id="[TFTD](@ref)"><a class="docs-heading-anchor" href="#[TFTD](@ref)"><a href="../../#TimeseriesSurrogates.TFTD"><code>TFTD</code></a></a><a id="[TFTD](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TFTD](@ref)" title="Permalink"></a></h3><p>The <a href="../../#TimeseriesSurrogates.TFTD"><code>TFTD</code></a> surrogate is a random Fourier surrogate where  the lowest frequencies are preserved during surrogate generation, and a  linear trend is removed during preprosessing and added again after the  surrogate has been generated. The <a href="../../#TimeseriesSurrogates.TFTD"><code>TFTD</code></a> surrogates do a decent  job at preserving long term trends.</p><pre><code class="language-julia hljs">using TimeseriesSurrogates

# Example signal
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

s = surrogate(x, TFTDRandomFourier(true, 0.02))
surroplot(x, s)</code></pre><img src="b5749fe2.png" alt="Example block output"/><h3 id="[TFTDAAFT](@ref)"><a class="docs-heading-anchor" href="#[TFTDAAFT](@ref)"><a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a></a><a id="[TFTDAAFT](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TFTDAAFT](@ref)" title="Permalink"></a></h3><p>The detrend-retrend extension of <a href="../../#TimeseriesSurrogates.TAAFT"><code>TAAFT</code></a> is the <a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a> method. The <a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a> method adds a rescaling step to the <a href="../../#TimeseriesSurrogates.TFTD"><code>TFTD</code></a> method, ensuring that the surrogate and the original time series consist of the same values. Long-term trends in the data are also decently preserved by <a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a>, but like <a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a>, there is some bias.</p><pre><code class="language-julia hljs">using TimeseriesSurrogates

# Example signal
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

# Keep 2 % of lowermost frequencies.
s = surrogate(x, TFTDAAFT(0.02))
surroplot(x, s)</code></pre><img src="4cd7fa57.png" alt="Example block output"/><h3 id="[TFTDIAAFT](@ref)"><a class="docs-heading-anchor" href="#[TFTDIAAFT](@ref)"><a href="../../#TimeseriesSurrogates.TFTDIAAFT"><code>TFTDIAAFT</code></a></a><a id="[TFTDIAAFT](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TFTDIAAFT](@ref)" title="Permalink"></a></h3><p><a href="../../#TimeseriesSurrogates.TFTDIAAFT"><code>TFTDIAAFT</code></a><sup class="footnote-reference"><a id="citeref-Lucio2012" href="#footnote-Lucio2012">[Lucio2012]</a></sup> surrogates are similar to <a href="../../#TimeseriesSurrogates.TFTDAAFT"><code>TFTDAAFT</code></a> surrogates, but the <a href="../../#TimeseriesSurrogates.TFTDIAAFT"><code>TFTDIAAFT</code></a><sup class="footnote-reference"><a id="citeref-Lucio2012" href="#footnote-Lucio2012">[Lucio2012]</a></sup> method also uses an iterative process to better match the power spectra of the original signal and the surrogate (analogous to how the <a href="../../#TimeseriesSurrogates.IAAFT"><code>IAAFT</code></a> method improves upon the <a href="../../#TimeseriesSurrogates.AAFT"><code>AAFT</code></a> method).</p><pre><code class="language-julia hljs">using TimeseriesSurrogates

# Example signal
n = 300; a = 0.7; A = 20; σ = 15
x = cumsum(randn(n)) .+ [(1 + a*i) .+ A*sin(2π/10*i) for i = 1:n] .+
    [A^2*sin(2π/2*i + π) for i = 1:n] .+ σ .* rand(n).^2;

# Keep 5% of lowermost frequences
s = surrogate(x, TFTDIAAFT(0.05))
surroplot(x, s)</code></pre><img src="dd63a597.png" alt="Example block output"/><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Lucio2012"><a class="tag is-link" href="#citeref-Lucio2012">Lucio2012</a>Lucio, J. H., Valdés, R., &amp; Rodríguez, L. R. (2012). Improvements to surrogate data methods for nonstationary time series. Physical Review E, 85(5), 056202.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../irregular_surrogates/">« Surrogates for irregular timeseries</a><a class="docs-footer-nextpage" href="../../man/exampleprocesses/">Utility systems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 20 June 2024 07:16">Thursday 20 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
